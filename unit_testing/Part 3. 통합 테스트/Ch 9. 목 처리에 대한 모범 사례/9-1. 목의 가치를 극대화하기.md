
비관리 의존성에만 목을 사용하게끔 제한하는 것이 중요하지만, 이는 목의 가치를 극대화하기 위한 첫 번째 단게일 뿐이다.

### 시스템 끝에서 상호작용 검증하기

회귀 방지는 테스트 중에 실행되는 코드 양에 대한 함수다. 비관리 의존성과 통신하는 마지막 타입을 목으로 처리하면 통합 테스트가 거치는 클래스의 수가 증가하므로 보호가 향상된다.

항상 시스템 끝에서 상호작용을 검증하라. 시스템 끝에서 상호작용을 검증하면 회귀 방지가 좋아질 뿐만 아니라 리팩터링 내성도 향상된다. 결국 테스트는 잠재적인 거짓 양성에 노출될 가능성이 낮아진다. 리팩터링을 하더라도 메시지 구조를 유지하는 한, 해당 테스트는 실패하지 않는다.

### 목을 스파이로 대체하기

스파이는 목과 같은 목적을 수행하는 테스트 대역이다. 스파이는 수동으로 작성하는 반면에 목은 목 프레임워크의 도움을 받아 생성한다는 것이 유일한 차이점이다. 실제로 스파이는 종종 직접 작성한 목이라고도 한다.

시스템 끝에 있는 클래스의 경우 스파이가 목보다 낫다. 스파이는 검증 단계에서 코드를 재사용해 테스트 크기를 줄이고 가독성을 향상시킨다.